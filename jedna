SELECT DISTINCT s.ServerID, s.ServerName
FROM Servers s
JOIN ServerFlags sf ON s.ServerID = sf.ServerID
JOIN Flags f ON sf.FlagID = f.FlagID
WHERE f.FlagID IN (
    SELECT af.FlagID
    FROM ApplicationFlags af
    WHERE af.ApplicationID = @ApplicationID
);
